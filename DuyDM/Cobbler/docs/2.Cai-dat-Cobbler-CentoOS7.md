# Ghi chép các bước cài đặt Cobbler trên CentOS7

### Mục lục

[1. Mô hình triển khai](#mohinh)<br>
[2. Thiết lập ban đầu](#thietlap)<br>
[3. Cài đặt](#caidat)<br>

<a name="mohinh"></a>
## 1. Mô hình triển khai

![](../images/cai-dat-centos7/topo-cobbler1.png)

- Bài lab thực hiện trên server cài đặt ảo hóa VMware.

- **Lưu ý**: Tắt DHCP server của mạng 10.10.14.0/24

<a name="thietlap"></a>
## 2. Thiết lập ban đầu

**Update**

```
yum install epel-release -y
yum update -y
```

**Cấu hình IP**


```
nmcli c modify ens160 ipv4.addresses 10.10.10.30/24
nmcli c modify ens160 ipv4.gateway 10.10.10.1
nmcli c modify ens160 ipv4.dns 8.8.8.8
nmcli c modify ens160 ipv4.method manual
nmcli con mod ens160 connection.autoconnect yes
sudo systemctl disable firewalld
sudo systemctl stop firewalld
sudo systemctl disable NetworkManager
sudo systemctl stop NetworkManager
sudo systemctl enable network
sudo systemctl start network
sed -i 's/SELINUX=enforcing/SELINUX=disabled/g' /etc/sysconfig/selinux
sed -i 's/SELINUX=enforcing/SELINUX=disabled/g' /etc/selinux/config
```

**Cài đặt NTPD**

```
yum install chrony -y 
```

```
systemctl start chronyd 
systemctl enable chronyd
systemctl restart chronyd 
```
 - Kiểm tra đồng bộ thời gian
 
```
chronyc sources -v
```

**Cài đặt CMD Log**

```
curl -Lso- https://raw.githubusercontent.com/nhanhoadocs/ghichep-cmdlog/master/cmdlog.sh | bash
```

<a name="caidat"></a>
## 3. Cài đặt

- Cài các package cần thiết cho cobbler

```
yum install cobbler cobbler-web dnsmasq syslinux xinetd bind bind-utils dhcp debmirror pykickstart fence-agents-all -y
```

+ **cobbler, cobbler-web**: Các package cài đặt chạy dịch vụ cobbler và giao diện web của cobbler.

+ **dnsmasq, bind, bind-utils, dhcp**: Các package chạy dịch vụ quản lý DNS và quản lý DHCP cho các máy client boot OS từ cobbler.

+ **syslinux**: Một chương trình bootloader và tiện ích cho phép đẩy vào client cho phép client boot OS qua mạng.(pxelinux)

+ **xinetd**: Tạo socket kết nối với máy client. Dựa vào cổng và giao thức (tcp hay udp) nó biết được phải trao đổi dữ liệu mà nó nhận được với back-end nào dựa vào thuộc tính server trong file cấu hình. Được sử dụng để quản lý và tạo socket cho TFTP server truyền file boot cho client.

+ **debmirror**: Package cài đặt cho phép tạo một mirror server chứa các gói phần mềm cài đặt của các distro trên một server local.
 
+ **pykickstart**: thư viện python cho phép đọc và chỉnh sửa nội dung file kickstart, hỗ trợ cobbler chỉnh sửa file kickstart thông qua giao diện web.

+ **fence-agents-all**
















